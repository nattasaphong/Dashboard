<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö/‡∏™‡πà‡∏á‡∏ú‡πâ‡∏≤</title>
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <style>
    body {
      font-family: "Sarabun", sans-serif;
      background: #fafafa;
      margin: 0;
      padding: 20px;
    }
    h1 {
      margin-bottom: 20px;
      font-size: 22px;
      color: #333;
    }
    .cards {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
    }
    .card {
      flex: 1;
      background: white;
      padding: 15px;
      border-radius: 12px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      text-align: center;
    }
    .card h2 {
      margin: 0;
      font-size: 24px;
      color: #007bff;
    }
    .card p {
      margin: 5px 0 0;
      color: #555;
    }
    .charts {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
    }
    #barChart, #gaugeChart {
      flex: 1;
      background: white;
      padding: 10px;
      border-radius: 12px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    table {
      border-collapse: collapse;
      width: 100%;
      background: white;
      border-radius: 12px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      overflow: hidden;
    }
    th, td {
      border-bottom: 1px solid #eee;
      padding: 10px;
      text-align: left;
      vertical-align: top;
    }
    th {
      background: #f5f5f5;
      font-weight: bold;
    }
    td img {
      width: 40px;
      height: 40px;
      object-fit: contain;
      margin-right: 8px;
      vertical-align: middle;
    }
  </style>
  <script>
    google.charts.load('current', {'packages':['corechart','gauge']});

    function drawDashboard(data) {
      // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏ö‡∏ô‡∏Å‡∏≤‡∏£‡πå‡∏î
      document.getElementById('totalReceive').innerText = data.totalReceive;
      document.getElementById('totalSend').innerText = data.totalSend;
      document.getElementById('pending').innerText = data.pending;

      // ‡∏ï‡∏≤‡∏£‡∏≤‡∏á
      const tbl = document.getElementById('itemsTable');
      let html = '<tr><th>‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏£‡∏á‡πÅ‡∏£‡∏°</th><th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th><th>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ú‡πâ‡∏≤</th></tr>';
      data.items.forEach(it => {
        html += `
          <tr>
            <td>
              <img src="${it.logo}" alt="${it.hotel}">
              ${it.hotel}
            </td>
            <td>${it.date}</td>
            <td>${it.items.map(x => `<div>${x}</div>`).join("")}</td>
          </tr>
        `;
      });
      tbl.innerHTML = html;

      // ‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏ó‡πà‡∏á
      const barData = google.visualization.arrayToDataTable([
        ['‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó', '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô'],
        ['‡∏£‡∏±‡∏ö', data.totalReceive],
        ['‡∏™‡πà‡∏á', data.totalSend]
      ]);
      const barChart = new google.visualization.ColumnChart(document.getElementById('barChart'));
      barChart.draw(barData, {title:'‡∏£‡∏ß‡∏°‡∏£‡∏±‡∏ö/‡∏™‡πà‡∏á', legend:{position:'none'}, height:300});

      // ‡∏Å‡∏£‡∏≤‡∏ü‡∏ß‡∏á‡∏Å‡∏•‡∏°‡πÅ‡∏ö‡∏ö Gauge
      const gaugeData = google.visualization.arrayToDataTable([
        ['Label', 'Value'],
        ['‡∏Ñ‡πâ‡∏≤‡∏á', data.pending]
      ]);
      const gaugeOptions = {
        width: 300, height: 300,
        redFrom: 70, redTo: 100,
        yellowFrom: 30, yellowTo: 70,
        minorTicks: 5
      };
      const gauge = new google.visualization.Gauge(document.getElementById('gaugeChart'));
      gauge.draw(gaugeData, gaugeOptions);
    }

    function loadData() {
      google.script.run.withSuccessHandler(drawDashboard).getLaundryData();
    }
    google.charts.setOnLoadCallback(loadData);
  </script>
</head>
<body>
  <h1>üìä ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö/‡∏™‡πà‡∏á‡∏ú‡πâ‡∏≤</h1>

  <!-- ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏™‡∏£‡∏∏‡∏õ -->
  <div class="cards">
    <div class="card">
      <h2 id="totalReceive">0</h2>
      <p>‡∏£‡∏ß‡∏°‡∏£‡∏±‡∏ö</p>
    </div>
    <div class="card">
      <h2 id="totalSend">0</h2>
      <p>‡∏£‡∏ß‡∏°‡∏™‡πà‡∏á</p>
    </div>
    <div class="card">
      <h2 id="pending">0</h2>
      <p>‡∏Ñ‡πâ‡∏≤‡∏á</p>
    </div>
  </div>

  <!-- ‡∏Å‡∏£‡∏≤‡∏ü -->
  <div class="charts">
    <div id="barChart"></div>
    <div id="gaugeChart"></div>
  </div>

  <!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á -->
  <table id="itemsTable"></table>
</body>
</html>
